<!DOCTYPE html>
<!-- saved from url=(0062)http://cloud.10oa.com/trial/common/fieldDate.htm?date,editable -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>colloa calendar</title>
<style type="text/css">
a:hover{
	color:#333;
}
a{
	text-decoration:none;
	color:#666;
	display:block;
}
select{
	font-family:tahoma,arial,verdana,sans-serif;
	font-size:13px;
}
table{
	font-family:tahoma,arial,verdana,sans-serif;
	font-size:13px;
	color:#454545;
  text-align:center;
}
.calendar th{
    background-color:#eee;
}
.calendar td{
    border: #eee 1px solid;
}
</style>
</head>

<body oncontextmenu="return false;"><table align="center" border="0" style="table-layout:fixed;width:280px;"><colgroup><col width="40"><col width="200"><col width="40">
</colgroup><tbody><tr><td><a href="javascript:navigateMonth(-1);">«</a></td><td id="vYearMonth"><select id="vYear" onchange="refreshDisplay()"><option value="1933">1933年</option><option value="1934">1934年</option><option value="1935">1935年</option><option value="1936">1936年</option><option value="1937">1937年</option><option value="1938">1938年</option><option value="1939">1939年</option><option value="1940">1940年</option><option value="1941">1941年</option><option value="1942">1942年</option><option value="1943">1943年</option><option value="1944">1944年</option><option value="1945">1945年</option><option value="1946">1946年</option><option value="1947">1947年</option><option value="1948">1948年</option><option value="1949">1949年</option><option value="1950">1950年</option><option value="1951">1951年</option><option value="1952">1952年</option><option value="1953">1953年</option><option value="1954">1954年</option><option value="1955">1955年</option><option value="1956">1956年</option><option value="1957">1957年</option><option value="1958">1958年</option><option value="1959">1959年</option><option value="1960">1960年</option><option value="1961">1961年</option><option value="1962">1962年</option><option value="1963">1963年</option><option value="1964">1964年</option><option value="1965">1965年</option><option value="1966">1966年</option><option value="1967">1967年</option><option value="1968">1968年</option><option value="1969">1969年</option><option value="1970">1970年</option><option value="1971">1971年</option><option value="1972">1972年</option><option value="1973">1973年</option><option value="1974">1974年</option><option value="1975">1975年</option><option value="1976">1976年</option><option value="1977">1977年</option><option value="1978">1978年</option><option value="1979">1979年</option><option value="1980">1980年</option><option value="1981">1981年</option><option value="1982">1982年</option><option value="1983">1983年</option><option value="1984">1984年</option><option value="1985">1985年</option><option value="1986">1986年</option><option value="1987">1987年</option><option value="1988">1988年</option><option value="1989">1989年</option><option value="1990">1990年</option><option value="1991">1991年</option><option value="1992">1992年</option><option value="1993">1993年</option><option value="1994">1994年</option><option value="1995">1995年</option><option value="1996">1996年</option><option value="1997">1997年</option><option value="1998">1998年</option><option value="1999">1999年</option><option value="2000">2000年</option><option value="2001">2001年</option><option value="2002">2002年</option><option value="2003">2003年</option><option value="2004">2004年</option><option value="2005">2005年</option><option value="2006">2006年</option><option value="2007">2007年</option><option value="2008">2008年</option><option value="2009">2009年</option><option value="2010">2010年</option><option value="2011">2011年</option><option value="2012">2012年</option><option value="2013">2013年</option><option value="2014">2014年</option><option value="2015">2015年</option><option value="2016">2016年</option><option value="2017">2017年</option><option selected="" value="2018">2018年</option><option value="2019">2019年</option><option value="2020">2020年</option><option value="2021">2021年</option><option value="2022">2022年</option><option value="2023">2023年</option><option value="2024">2024年</option><option value="2025">2025年</option><option value="2026">2026年</option><option value="2027">2027年</option><option value="2028">2028年</option><option value="2029">2029年</option><option value="2030">2030年</option><option value="2031">2031年</option><option value="2032">2032年</option></select><select id="vMonth" onchange="refreshDisplay()"><option value="1">一月</option><option value="2">二月</option><option value="3">三月</option><option value="4">四月</option><option value="5">五月</option><option value="6">六月</option><option value="7">七月</option><option value="8">八月</option><option value="9">九月</option><option selected="" value="10">十月</option><option value="11">十一月</option><option value="12">十二月</option></select></td><td><a href="javascript:navigateMonth(1);">»</a></td></tr></tbody></table>

<table class="calendar" align="center" border="0" cellpadding="2" cellspacing="1" style="table-layout:fixed;width:280px;">
<tbody><tr><th id="w">日</th><th id="w">一</th><th id="w">二</th><th id="w">三</th><th id="w">四</th><th id="w">五</th><th id="w">六</th></tr>
<tr><td id="d" bgcolor=""></td><td id="d"><a href="javascript:returnValue(1);">1</a></td><td id="d"><a href="javascript:returnValue(2);">2</a></td><td id="d"><a href="javascript:returnValue(3);">3</a></td><td id="d"><a href="javascript:returnValue(4);">4</a></td><td id="d"><a href="javascript:returnValue(5);">5</a></td><td id="d"><a href="javascript:returnValue(6);">6</a></td></tr>
<tr><td id="d"><a href="javascript:returnValue(7);">7</a></td><td id="d"><a href="javascript:returnValue(8);">8</a></td><td id="d"><a href="javascript:returnValue(9);">9</a></td><td id="d"><a href="javascript:returnValue(10);">10</a></td><td id="d"><a href="javascript:returnValue(11);">11</a></td><td id="d"><a href="javascript:returnValue(12);">12</a></td><td id="d"><a href="javascript:returnValue(13);">13</a></td></tr>
<tr><td id="d"><a href="javascript:returnValue(14);">14</a></td><td id="d" bgcolor="#eeeeee"><a href="javascript:returnValue(15);">15</a></td><td id="d"><a href="javascript:returnValue(16);">16</a></td><td id="d"><a href="javascript:returnValue(17);">17</a></td><td id="d"><a href="javascript:returnValue(18);">18</a></td><td id="d"><a href="javascript:returnValue(19);">19</a></td><td id="d"><a href="javascript:returnValue(20);">20</a></td></tr>
<tr><td id="d"><a href="javascript:returnValue(21);">21</a></td><td id="d"><a href="javascript:returnValue(22);">22</a></td><td id="d"><a href="javascript:returnValue(23);">23</a></td><td id="d"><a href="javascript:returnValue(24);">24</a></td><td id="d"><a href="javascript:returnValue(25);">25</a></td><td id="d"><a href="javascript:returnValue(26);">26</a></td><td id="d"><a href="javascript:returnValue(27);">27</a></td></tr>
<tr><td id="d"><a href="javascript:returnValue(28);">28</a></td><td id="d"><a href="javascript:returnValue(29);">29</a></td><td id="d"><a href="javascript:returnValue(30);">30</a></td><td id="d"><a href="javascript:returnValue(31);">31</a></td><td id="d"></td><td id="d"></td><td id="d"></td></tr>
<tr><td id="d"></td><td id="d"></td><td id="d"></td><td id="d"></td><td id="d"></td><td id="d"></td><td id="d"></td></tr>
</tbody></table>

<script language="javaScript">
var sLang=(parent&&parent._sLang)?parent._sLang:"cn";

var vWeekArray,vMonthArray,vYearArray;
if(sLang=="cn" || sLang=="tc")
{
    vWeekArray=["日","一","二","三","四","五","六"];
    vMonthArray=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"];
    vYearArray="年";
}
else
{
    vWeekArray=["S","M","T","W","T","F","S"];
    vMonthArray=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    vYearArray="";
}    

//To be enhanced to initilize the year, month and day with arguments
var vInitYear=new Date().getFullYear();
var vInitMonth=new Date().getMonth()+1;
var vInitDay=new Date().getDate();

buildYearMonthWeekArray(vInitYear,vInitMonth);
var vYear=document.getElementById('vYear');
var vMonth=document.getElementById('vMonth');
var vDayArray=[];
var vInitDayIndex=0;
refreshDisplay();

function buildYearMonthWeekArray(y,m)
{
	var s;
  if(sLang=="cn" || sLang=="tc")
	{
      s="<select id=vYear onchange='refreshDisplay()'>";
      for(var i=(y-85);i<y;i++) s+="<option value="+i+">"+i+vYearArray+"</option>";
      s+="<option selected value="+y+">"+y+vYearArray+"</option>";
      for(var i=(y+1);i<(y+15);i++) s+="<option value="+i+">"+i+vYearArray+"</option>";
      s+="</select><select id=vMonth onchange='refreshDisplay()'>";
      for(var i=1;i<m;i++) s+="<option value="+i+">"+vMonthArray[i-1]+"</option>";
      s+="<option selected value="+m+">"+vMonthArray[m-1]+"</option>";
      for(var i=(m+1);i<13;i++) s+="<option value="+i+">"+vMonthArray[i-1]+"</option>";
      s+="</select>";
  }
  else
  {
      s="<select id=vMonth onchange='refreshDisplay()'>";
      for(var i=1;i<m;i++) s+="<option value="+i+">"+vMonthArray[i-1]+"</option>";
      s+="<option selected value="+m+">"+vMonthArray[m-1]+"</option>";
      for(var i=(m+1);i<13;i++) s+="<option value="+i+">"+vMonthArray[i-1]+"</option>";
      s+="</select><select id=vYear onchange='refreshDisplay()'>";
      for(var i=(y-85);i<y;i++) s+="<option value="+i+">"+i+vYearArray+"</option>";
      s+="<option selected value="+y+">"+y+vYearArray+"</option>";
      for(var i=(y+1);i<(y+15);i++) s+="<option value="+i+">"+i+vYearArray+"</option>";
      s+="</select>";
  }
	document.getElementById('vYearMonth').innerHTML=s;
	var vWeeks = document.all('w');
	for(var i=0;i<7;i++) vWeeks[i].innerHTML=vWeekArray[i];
}
function buildDayArray(y,m)
{
	var d1=new Date(y,m,0).getDate();
	var d2=new Date(y,m-1,1).getDay();
	for(var i=0;i<42;i++) vDayArray[i]="";
	vInitDayIndex=d1+d2-1;
	for(var i=0;i<d1;i++)
	{
		if((i+1)==vInitDay) vInitDayIndex=i+d2;
		vDayArray[i+d2]=i+1;
	}
}
function navigateMonth(count)
{
	if(count==-1)
	{
		if(vMonth.selectedIndex==0)
		{
			if(vYear.selectedIndex==0) return;
			vMonth.options[vMonth.options.length-1].selected=true;
			vYear.options[vYear.selectedIndex-1].selected=true;
		}
		else vMonth.options[vMonth.selectedIndex-1].selected=true;
	}
	else if(count==1)
	{
		if(vMonth.selectedIndex==vMonth.options.length-1)
		{
			if(vYear.selectedIndex==vYear.options.length-1) return;
			vMonth.options[0].selected=true;
			vYear.options[vYear.selectedIndex+1].selected=true;
		}
		else vMonth.options[vMonth.selectedIndex+1].selected=true;
	}
	refreshDisplay();
}
function refreshDisplay()
{
	var vDays = document.all('d');
	vDays[vInitDayIndex].bgColor = "";
	buildDayArray(vYear.value, vMonth.value);
	for(var i=0;i<42;i++) vDays[i].innerHTML=vDayArray[i]?"<a href='javascript:returnValue("+vDayArray[i]+");'>"+vDayArray[i]+"</a>":"";
	vDays[vInitDayIndex].bgColor="#eeeeee";
}
function returnValue(v)
{
    if (window.parent) {
        if(parent._eLastActiveEvent) {
            var e = parent._eLastActiveEvent.parentNode.lastChild;
			if(e.tagName != "DIV") e = e.previousSibling;
			e.innerHTML = vYear.value + "/" + vMonth.value + "/" + v;
        }
        if (parent._eLastActiveSource) {
            parent._eLastActiveSource.style.display = "none";
            parent._eLastActiveSource = null;
        }
    }
}
</script>


</body></html>